/* InfiScroll */"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var i=[],n=!0,r=!1,s=void 0;try{for(var l,_=e[Symbol.iterator]();!(n=(l=_.next()).done)&&(i.push(l.value),!t||i.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==_.return||_.return()}finally{if(r)throw s}}return i}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(){var h="InfiScroll",a=Object.freeze({TRESHOLD:"treshold",ELEMENT_LIMIT:"elementLimit",SIZE:"size",QUERY:"generator",FIXED_SIZE:"fixedSize",CHILD_SIZE:"childSize",CACHE_SIZE:"cacheSize",INVALIDATE_CHECK:"check",DOM_DELETE:"domDelete",TOGGLE_SPINNER:"spinner",THROTTLE_SCROLL:"throttleScroll"});if(!window)throw new Error("".concat(h," cannot be used in non-browser environment"));function u(e,t,i,n){if(!n)return[0];var r,s,l=Math.max(e-i,0)/n>>>0,_=t+2*i-(l*n-e),o=Math.ceil(_/n);return r=l,s=o,Array.from(Array(s||1),function(e,t){return r+t})}function d(e){return"__".concat(h,"_").concat(this.__uniqueIdentifier,"_index_").concat(e)}function l(e,t,i){var n=e*this.__childSize;if(t.style.position="absolute",t.style.margin=0,t.style.top="".concat(n,"px"),t.style.left=0,t.style.right=0,t.id=d.call(this,e),this.__childSize&&(t.style.height="".concat(this.__childSize,"px")),i){var r=t.id,s=document.getElementById(r);this.element.insertBefore(t,s),this.element.removeChild(s)}else this.element.appendChild(t);if(this.__childSize||(this.__childSize=t.scrollHeight,this.__treshold=c.call(this),function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.__domElements[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value,l=d.call(this,s),_=document.getElementById(l);_&&(_.style.height="".concat(this.__childSize,"px"))}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}}.call(this),setTimeout(this.invalidate.bind(this),0),this.__fixedSize&&m.call(this)),!(e===this.__size)){var l=this.element.scrollHeight,_=(this.__size+1)*this.__childSize,o=n+5*this.__childSize;l<o&&(!_||o<_)&&(this.__dummyElement.style.top="".concat(o,"px"),this.__dummyElement.offsetParent||this.element.appendChild(this.__dummyElement))}}function c(){return this.__tresholdFactor*this.__childSize}function m(){this.__fixedSize&&(this.__dummyElement.style.top="".concat(this.__childSize*(this.__size+1),"px"),this.element.appendChild(this.__dummyElement))}function f(e,t){if(null!=t){if(!(t instanceof HTMLElement))throw Error("".concat(h," query callback resolved with non-HTMLElement result."));this.__queries.delete(e),this.__cache.delete(e);var i=this.__cacheQueue.indexOf(e);-1!=i&&this.__cacheQueue.splice(i,1),this.__domElements.add(e),(!this.__lastItemGenerated||e>this.__lastItemGenerated)&&(this.__lastItemGenerated=e),l.call(this,e,t)}else(function(){if(!this.__size&&this.__lastItemGenerated){var e=this.__lastItemGenerated*this.__childSize;this.__dummyElement&&(this.__dummyElement.style.top="".concat(e,"px")),this.__spinner&&this.__spinner(!1)}}).call(this)}function e(e,t){var i=this;if(!(e instanceof HTMLElement))throw Error("".concat(e," is not instance of HTMLElement"));this.element=e;var n=window.getComputedStyle(e);if(!~["absolute","relative"].indexOf(n.position))throw Error("".concat(e," must have position of 'absolute' or 'relative'"));if(!t)throw Error("options argument must be passed to ".concat(h," constructor"));this.__resizeListener=function(){i.invalidate()},window.addEventListener("resize",this.__resizeListener);var r=this.element.id;r||(r=1e6*Math.random()>>>0);var s,l,_=null;for(this.__scrollListener=function(){if(i.__throttleScroll){null!==_&&clearTimeout(_);var e=i;_=setTimeout(function(){e.invalidate(),_=null},50)}else i.invalidate()},this.__scrollListener.bind(this),e.addEventListener("scroll",this.__scrollListener);this.element.firstChild;)this.element.removeChild(this.element.firstChild);if(this.__domElements=new Set,this.__inView=new Set,this.__queue=[],this.__cacheQueue=[],this.__cache=new Map,this.__queries=new Set,this.__updateRequests=new Map,this.__uniqueIdentifier=r,this.__spinnerTimeout=null,function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=i.filter(function(e){return!(e in t)});if(r.length)throw Error("Options object is missing required properties ".concat(r))}(t,a.QUERY),this.__query=t[a.QUERY],this.__check=t[a.INVALIDATE_CHECK],this.__childSize=t[a.CHILD_SIZE],this.__fixedSize=t[a.FIXED_SIZE],this.__size=t[a.SIZE],this.__elementLimit=t[a.ELEMENT_LIMIT],this.__cacheSize=t[a.CACHE_SIZE],this.__domDelete=t[a.DOM_DELETE],this.__spinner=t[a.TOGGLE_SPINNER],this.__throttleScroll=!(a.THROTTLE_SCROLL in t)||t[a.THROTTLE_SCROLL],this.__tresholdFactor=a.TRESHOLD in t?t[a.TRESHOLD]:.5,this.__childSize&&(this.__treshold=c.call(this)),this.__spinner&&"function"!=typeof this.__spinner)throw Error("Given spinner callback is not function. Provide a function which takes a single boolean parameter.");(l=Object.keys(t).filter(function(e){return!~Object.values(a).indexOf(e)})).length&&(s="Options object contained invalid options '".concat(l,"'. Typos?"),console.warn("".concat(h,": ").concat(s)));var o=document.createElement("div");o.style.height=o.style.width="1px",o.style.visibility="hidden",o.style.position="absolute",this.__dummyElement=o,m.call(this),setTimeout(this.invalidate.bind(this),0)}if(e.prototype.reload=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.__domElements.clear(),this.__inView.clear(),this.__cache.clear(),this.__queries.clear(),this.__updateRequests.clear(),this.__queue=[],this.__cacheQueue=[],this.__dummyElement.top=0,this.invalidate()},e.prototype.invalidate=function(){var a=this;if(!(0<arguments.length&&void 0!==arguments[0]&&arguments[0])){if(this.__check&&!this.__check())return;if(null===this.element.offsetParent)return}var e=u(this.element.scrollTop,this.element.clientHeight,this.__treshold,this.__childSize),t=e.filter(function(e){return!a.__domElements.has(e)});if(this.__inView=new Set(e),t.filter(function(e){return!a.__size||e<=a.__size}).forEach(function(e){return a.__queue.push(e)}),this.__elementLimit){for(var c=[],i=0;this.__queue.length>this.__elementLimit&&i++<this.__queue.length;){var n=this.__queue.shift();this.__inView.has(n)||this.__queries.has(n)||c.push(n)}if(c.length){setTimeout(function(){var e=function(n){for(var r=this,s=new Map,e=arguments.length,t=new Array(1<e?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return t.reduce(function(e,t){return e.concat(t)}).forEach(function(e){var t=d.call(r,e),i=document.getElementById(t);i&&(s.set(e,i),n.removeChild(i))}),s}.call(a,a.element,c),t=!0,i=!1,n=void 0;try{for(var r,s=e.entries()[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var l=_slicedToArray(r.value,2),_=l[0],o=l[1];a.__cacheQueue.push(_),a.__cache.set(_,o),a.__domElements.delete(_),a.__domDelete&&__domDelete(o)}}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}for(;a.__cacheSize&&a.__cacheQueue.length>a.__cacheSize;){var h=a.__cacheQueue.shift();a.__cache.delete(h)}}.bind(this),0)}}var r=!0,s=!1,l=void 0;try{for(var _,o=function(){var t=_.value;if(a.__size&&t>=a.__size)return"continue";if(a.__spinner){a.__spinner(!0),clearTimeout(a.__spinnerTimeout);var e=a.__spinner;a.__spinnerTimeout=setTimeout(function(){return e(!1)},100)}if(!a.__queries.has(t))if(a.__cache.has(t))f.call(a,t,a.__cache.get(t));else{var i=f.bind(a);a.__query.bind(a)(t,function(e){return i(t,e)})}},h=t[Symbol.iterator]();!(r=(_=h.next()).done);r=!0)o()}catch(e){s=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(s)throw l}}},e.prototype.updateItem=function(t){var i=this;if(this.__domElements.has(t)){var n=1e3*Math.random()>>>0;this.__updateRequests.set(t,n);for(var e=arguments.length,r=new Array(1<e?e-1:0),s=1;s<e;s++)r[s-1]=arguments[s];this.__query.apply(this,[t,function(e){i.__updateRequests.get(t)===n&&l.call(i,t,e,!0)}].concat(r))}},e.prototype.updateSize=function(e){if(!e||+e<0)throw Error("Invalid size ".concat(e));this.__size=+e,m.call(this)},e.prototype.dispose=function(){window.removeEventListener("resize",this.__resizeListener),this.element.removeEventListener("scroll",this.__scrollListener)},h in window)throw new Error("CLASH: Global property ".concat(h," exist already in window!"));window[h]=e}();